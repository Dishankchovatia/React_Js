"use strict";(self.webpackChunkreact_complete_guide=self.webpackChunkreact_complete_guide||[]).push([[857],{995:(e,t,n)=>{n.d(t,{Z:()=>c});var s=n(791);function o(e,t){return"SEND"===t.type?{data:null,error:null,status:"pending"}:"SUCCESS"===t.type?{data:t.responseData,error:null,status:"completed"}:"ERROR"===t.type?{data:null,error:t.errorMessage,status:"completed"}:e}const c=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const[n,c]=(0,s.useReducer)(o,{status:t?"pending":null,data:null,error:null});return{sendRequest:(0,s.useCallback)((async function(t){c({type:"SEND"});try{const n=await e(t);c({type:"SUCCESS",responseData:n})}catch(n){c({type:"ERROR",errorMessage:n.message||"Something went wrong!"})}}),[e]),...n}}},853:(e,t,n)=>{n.d(t,{Ir:()=>r,KP:()=>a,Lf:()=>o,h_:()=>d,jR:()=>c});const s="https://react-js-45cbf-default-rtdb.firebaseio.com";async function o(){const e=await fetch("".concat(s,"/quotes.json")),t=await e.json();if(!e.ok)throw new Error(t.message||"Could not fetch quotes.");const n=[];for(const s in t){const e={id:s,...t[s]};n.push(e)}return n}async function c(e){const t=await fetch("".concat(s,"/quotes/").concat(e,".json")),n=await t.json();if(!t.ok)throw new Error(n.message||"Could not fetch quote.");return{id:e,...n}}async function a(e){const t=await fetch("".concat(s,"/quotes.json"),{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}),n=await t.json();if(!t.ok)throw new Error(n.message||"Could not create quote.");return null}async function r(e){const t=await fetch("".concat(s,"/comments/").concat(e.quoteId,".json"),{method:"POST",body:JSON.stringify(e.commentData),headers:{"Content-Type":"application/json"}}),n=await t.json();if(!t.ok)throw new Error(n.message||"Could not add comment.");return{commentId:n.name}}async function d(e){const t=await fetch("".concat(s,"/comments/").concat(e,".json")),n=await t.json();if(!t.ok)throw new Error(n.message||"Could not get comments.");const o=[];for(const s in n){const e={id:s,...n[s]};o.push(e)}return o}},857:(e,t,n)=>{n.r(t),n.d(t,{default:()=>N});var s=n(791),o=n(880),c=n(523);const a="HighlightedQuote_quote__xyZGR";var r=n(184);const d=e=>(0,r.jsxs)("figure",{className:a,children:[(0,r.jsx)("p",{children:e.text}),(0,r.jsx)("figcaption",{children:e.author})]}),m="Comments_comments__a4x+D";var l=n(995),i=n(853),u=n(556);const h="NewCommentForm_form__4zgOh",j="NewCommentForm_control__irGrs",f="NewCommentForm_actions__dv6Ql",x=e=>{const t=(0,s.useRef)(),{sendRequest:n,status:o,error:c}=(0,l.Z)(i.Ir),{onAddedComment:a}=e;(0,s.useEffect)((()=>{"completed"!==o||c||a()}),[o,c,a]);const d=s=>{s.preventDefault();const o=t.current.value;n({commentData:{text:o},quoteId:e.quoteId})};return(0,r.jsxs)("form",{className:h,onSubmit:d,children:["pending"===o&&(0,r.jsx)("div",{className:"centered",children:(0,r.jsx)(u.Z,{})}),(0,r.jsxs)("div",{className:j,onSubmit:d,children:[(0,r.jsx)("label",{htmlFor:"comment",children:"Your Comment"}),(0,r.jsx)("textarea",{id:"comment",rows:"5",ref:t})]}),(0,r.jsx)("div",{className:f,children:(0,r.jsx)("button",{className:"btn",children:"Add Comment"})})]})},p="CommentItem_item__XpGPS",w=e=>(0,r.jsx)("li",{className:p,children:(0,r.jsx)("p",{children:e.text})}),g="CommentsList_comments__qDLBq",C=e=>(0,r.jsx)("ul",{className:g,children:e.comments.map((e=>(0,r.jsx)(w,{text:e.text},e.id)))}),_=()=>{const[e,t]=(0,s.useState)(!1),n=(0,o.UO)(),{quoteId:c}=n,{sendRequest:a,status:d,data:h}=(0,l.Z)(i.h_);(0,s.useEffect)((()=>{a(c)}),[c,a]);const j=(0,s.useCallback)((()=>{a(c)}),[a,c]);let f;return"pending"===d&&(f=(0,r.jsx)("div",{className:"centered",children:(0,r.jsx)(u.Z,{})})),"completed"===d&&h&&h.length>0&&(f=(0,r.jsx)(C,{comments:h})),"completed"!==d||h&&0!==h.length||(f=(0,r.jsx)("p",{className:"centered",children:"No comments were added yet!"})),(0,r.jsxs)("section",{className:m,children:[(0,r.jsx)("h2",{children:"User Comments"}),!e&&(0,r.jsx)("button",{className:"btn",onClick:()=>{t(!0)},children:"Add a Comment"}),e&&(0,r.jsx)(x,{quoteId:c,onAddedComment:j}),f]})},N=()=>{const e=(0,o.$B)(),t=(0,o.UO)(),{quoteId:n}=t,{sendRequest:a,status:m,data:h,error:j}=(0,l.Z)(i.jR,!0);return(0,s.useEffect)((()=>{a(n)}),[a,n]),"pending"===m?(0,r.jsx)("div",{className:"centered",children:(0,r.jsx)(u.Z,{})}):j?(0,r.jsx)("p",{className:"centered",children:j}):h.text?(0,r.jsxs)(s.Fragment,{children:[(0,r.jsx)(d,{text:h.text,author:h.author}),(0,r.jsx)(o.AW,{path:e.path,exact:!0,children:(0,r.jsx)("div",{className:"centered",children:(0,r.jsx)(c.rU,{className:"btn--flat",to:"".concat(e.url,"/comments"),children:"Load Comments"})})}),(0,r.jsx)(o.AW,{path:"".concat(e.path,"/comments"),children:(0,r.jsx)(_,{})})]}):(0,r.jsx)("p",{children:"No quote found!"})}}}]);
//# sourceMappingURL=857.ab1a917a.chunk.js.map